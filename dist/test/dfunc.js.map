{"version":3,"sources":["../../src/dfunc.js"],"names":["index","categories","Arithmatic","Interpolation","Timeshift","Rate","Smoothing","Rollup","Rank","Count","Regression","Algorithms","addFuncDef","funcDef","params","defaultParams","append","category","push","name","type","options","optional","_","each","funcList","catName","sortBy","FuncInstance","def","withDefaultParams","slice","updateText","prototype","render","metricExp","str","parameters","map","value","unshift","funcRender","join","console","log","updateParam","strValue","splice","length","text","createFuncInstance","isString","message","getFuncDef","getCategories","foo"],"mappings":"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","sourcesContent":["import _ from 'lodash';\n\nvar index = [];\nvar categories = {\n  Arithmatic: [],\n  Interpolation: [],\n  Timeshift: [],\n  Rate: [],\n  Smoothing: [],\n  Rollup: [],\n  Rank: [],\n  Count: [],\n  Regression: [],\n  Algorithms: []\n};\n\nfunction addFuncDef(funcDef) {\n  funcDef.params = funcDef.params || [];\n  funcDef.defaultParams = funcDef.defaultParams || [];\n  funcDef.append = funcDef.append || false;\n  if (funcDef.category) {\n    funcDef.category.push(funcDef);\n  }\n  index[funcDef.name] = funcDef;\n  index[funcDef.name] = funcDef;\n}\n\naddFuncDef({\n  name: 'abs',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'log2',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'cumsum',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'integral',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'fill',\n  category: categories.Interpolation,\n  params: [\n    { name: \"fill\", type: 'string', options: ['null', 'zero', 'linear', 'last'] },\n    { name: \"limit\", type: 'int', optional: true},\n  ],\n  defaultParams: ['zero'],\n  append: true,\n});\n\naddFuncDef({\n  name: 'hour_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'day_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'week_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'month_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'per_second',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'per_minute',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'per_hour',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'dt',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'diff',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'derivative',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'ewma_3',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'ewma_5',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'ewma_10',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'ewma_20',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_3',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_5',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_7',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_9',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'rollup',\n  category: categories.Rollup,\n  params: [\n    { name: \"rollup\", type: 'string', options: ['sum', 'avg', 'min', 'max'] },\n    { name: \"period\", type: 'int'},\n  ],\n  defaultParams: ['sum', 600],\n  append: true\n});\n\naddFuncDef({\n  name: 'count_nonzero',\n  category: categories.Count,\n});\n\naddFuncDef({\n  name: 'count_not_null',\n  category: categories.Count,\n});\n\naddFuncDef({\n  name: 'top',\n  category: categories.Rank,\n  params: [\n    { name: \"top\", type: 'int', options: [5, 10, 15]},\n    { name: \"aggr\", type: 'string', options: ['mean', 'min', 'max', 'area', 'l2norm', 'last']},\n    { name: \"dir\", type: 'string', options: ['asc', 'desc']},\n  ],\n  defaultParams: [5, 'mean', 'dir'],\n});\n\naddFuncDef({\n  name: 'robust_trend',\n  category: categories.Regression,\n});\n\naddFuncDef({\n  name: 'piecewise_constant',\n  category: categories.Regression,\n});\n\naddFuncDef({\n  name: 'anomalies',\n  category: categories.Algorithms,\n  params: [\n    { name: \"anomalies\", type: 'string', options: ['basic', 'agile', 'robust', 'adaptive']},\n    { name: \"bonds\", type: 'int', options: [1, 2, 3, 4, 5, 6]},\n  ],\n  defaultParams: ['basic', 2],\n});\n\naddFuncDef({\n  name: 'anomalies',\n  category: categories.Algorithms,\n  params: [\n    { name: \"anomalies\", type: 'string', options: ['basic', 'agile', 'robust', 'adaptive']},\n    { name: \"bonds\", type: 'int', options: [1, 2, 3, 4, 5, 6]},\n  ],\n  defaultParams: ['basic', 2],\n});\n\naddFuncDef({\n  name: 'outliers',\n  category: categories.Algorithms,\n  params: [\n    { name: \"outliers\", type: 'string', options: ['DBSCAN', 'MAD', 'scaledDBSCAN', 'scaledMAD']},\n    { name: \"tolerance\", type: 'int', options: [\n      0.33,\n      0.5,\n      1,\n      1.5,\n      2.0,\n      2.5,\n      3.0,\n      3.5,\n      4.0,\n      4.5,\n      5.0]},\n  ],\n  defaultParams: ['basic', 2],\n});\n\n_.each(categories, function(funcList, catName) {\n  categories[catName] = _.sortBy(funcList, 'name');\n});\n\nfunction FuncInstance(funcDef, options) {\n  this.def = funcDef;\n  this.params = [];\n\n  if (options && options.withDefaultParams) {\n    this.params = funcDef.defaultParams.slice(0);\n  }\n\n  this.updateText();\n}\n\nFuncInstance.prototype.render = function(metricExp) {\n  var str = this.def.name + '(';\n  var parameters = _.map(this.params, function(value) {\n    return value;\n  });\n  if (metricExp && !this.def.append) {\n    parameters.unshift(metricExp);\n  }\n\n  var funcRender = str + parameters.join(', ') + ')';\n  console.log(funcRender, this.def.append);\n  if (this.def.append) {\n    return metricExp + '.' + funcRender;\n  } else {\n    return funcRender;\n  }\n};\n\nFuncInstance.prototype.updateParam = function(strValue, index) {\n  // handle optional parameters\n  // if string contains ',' and next param is optional, split and update both\n\n  if (strValue === '' && this.def.params[index].optional) {\n    this.params.splice(index, 1);\n  }\n  else {\n    this.params[index] = strValue;\n  }\n\n  this.updateText();\n};\n\nFuncInstance.prototype.updateText = function () {\n  if (this.params.length === 0) {\n    this.text = this.def.name + '()';\n    return;\n  }\n\n  var text = this.def.name + '(';\n  text += this.params.join(', ');\n  text += ')';\n  this.text = text;\n};\n\nvar createFuncInstance = function(funcDef, options) {\n  if (_.isString(funcDef)) {\n    if (!index[funcDef]) {\n      throw { message: 'Method not found ' + name };\n    }\n    funcDef = index[funcDef];\n  }\n  return new FuncInstance(funcDef, options);\n};\n\nvar getFuncDef = function(name) {\n  return index[name];\n};\n\nvar getCategories = function() {\n  return categories;\n};\n\nvar foo;\n\nexport default foo = {\n  createFuncInstance: createFuncInstance,\n  getFuncDef: getFuncDef,\n  getCategories: getCategories,\n};\n\n"],"file":"dfunc.js"}