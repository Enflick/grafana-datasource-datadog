{"version":3,"sources":["../src/dfunc.js"],"names":["addFuncDef","funcDef","params","defaultParams","append","category","push","index","name","FuncInstance","options","def","withDefaultParams","slice","updateText","_","categories","Arithmatic","Interpolation","Timeshift","Rate","Smoothing","Rollup","Rank","Count","Regression","Algorithms","type","optional","each","funcList","catName","sortBy","prototype","render","metricExp","str","parameters","map","value","unshift","funcRender","join","console","log","updateParam","strValue","splice","length","text","createFuncInstance","isString","message","getFuncDef","getCategories","foo"],"mappings":"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","sourcesContent":["import _ from 'lodash';\n\nvar index = [];\nvar categories = {\n  Arithmatic: [],\n  Interpolation: [],\n  Timeshift: [],\n  Rate: [],\n  Smoothing: [],\n  Rollup: [],\n  Rank: [],\n  Count: [],\n  Regression: [],\n  Algorithms: []\n};\n\nfunction addFuncDef(funcDef) {\n  funcDef.params = funcDef.params || [];\n  funcDef.defaultParams = funcDef.defaultParams || [];\n  funcDef.append = funcDef.append || false;\n  if (funcDef.category) {\n    funcDef.category.push(funcDef);\n  }\n  index[funcDef.name] = funcDef;\n  index[funcDef.name] = funcDef;\n}\n\naddFuncDef({\n  name: 'abs',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'log2',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'cumsum',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'integral',\n  category: categories.Arithmatic,\n});\n\naddFuncDef({\n  name: 'fill',\n  category: categories.Interpolation,\n  params: [\n    { name: \"fill\", type: 'string', options: ['null', 'zero', 'linear', 'last'] },\n    { name: \"limit\", type: 'int', optional: true},\n  ],\n  defaultParams: ['zero'],\n  append: true,\n});\n\naddFuncDef({\n  name: 'hour_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'day_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'week_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'month_before',\n  category: categories.Timeshift,\n});\n\naddFuncDef({\n  name: 'per_second',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'per_minute',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'per_hour',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'dt',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'diff',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'derivative',\n  category: categories.Rate,\n});\n\naddFuncDef({\n  name: 'ewma_3',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'ewma_5',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'ewma_10',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'ewma_20',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_3',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_5',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_7',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'median_9',\n  category: categories.Smoothing,\n});\n\naddFuncDef({\n  name: 'rollup',\n  category: categories.Rollup,\n  params: [\n    { name: \"rollup\", type: 'string', options: ['sum', 'avg', 'min', 'max'] },\n    { name: \"period\", type: 'int'},\n  ],\n  defaultParams: ['sum', 600],\n  append: true\n});\n\naddFuncDef({\n  name: 'count_nonzero',\n  category: categories.Count,\n});\n\naddFuncDef({\n  name: 'count_not_null',\n  category: categories.Count,\n});\n\naddFuncDef({\n  name: 'top',\n  category: categories.Rank,\n  params: [\n    { name: \"top\", type: 'int', options: [5, 10, 15]},\n    { name: \"aggr\", type: 'string', options: ['mean', 'min', 'max', 'area', 'l2norm', 'last']},\n    { name: \"dir\", type: 'string', options: ['asc', 'desc']},\n  ],\n  defaultParams: [5, 'mean', 'dir'],\n});\n\naddFuncDef({\n  name: 'robust_trend',\n  category: categories.Regression,\n});\n\naddFuncDef({\n  name: 'piecewise_constant',\n  category: categories.Regression,\n});\n\naddFuncDef({\n  name: 'anomalies',\n  category: categories.Algorithms,\n  params: [\n    { name: \"anomalies\", type: 'string', options: ['basic', 'agile', 'robust', 'adaptive']},\n    { name: \"bonds\", type: 'int', options: [1, 2, 3, 4, 5, 6]},\n  ],\n  defaultParams: ['basic', 2],\n});\n\naddFuncDef({\n  name: 'anomalies',\n  category: categories.Algorithms,\n  params: [\n    { name: \"anomalies\", type: 'string', options: ['basic', 'agile', 'robust', 'adaptive']},\n    { name: \"bonds\", type: 'int', options: [1, 2, 3, 4, 5, 6]},\n  ],\n  defaultParams: ['basic', 2],\n});\n\naddFuncDef({\n  name: 'outliers',\n  category: categories.Algorithms,\n  params: [\n    { name: \"outliers\", type: 'string', options: ['DBSCAN', 'MAD', 'scaledDBSCAN', 'scaledMAD']},\n    { name: \"tolerance\", type: 'int', options: [\n      0.33,\n      0.5,\n      1,\n      1.5,\n      2.0,\n      2.5,\n      3.0,\n      3.5,\n      4.0,\n      4.5,\n      5.0]},\n  ],\n  defaultParams: ['basic', 2],\n});\n\n_.each(categories, function(funcList, catName) {\n  categories[catName] = _.sortBy(funcList, 'name');\n});\n\nfunction FuncInstance(funcDef, options) {\n  this.def = funcDef;\n  this.params = [];\n\n  if (options && options.withDefaultParams) {\n    this.params = funcDef.defaultParams.slice(0);\n  }\n\n  this.updateText();\n}\n\nFuncInstance.prototype.render = function(metricExp) {\n  var str = this.def.name + '(';\n  var parameters = _.map(this.params, function(value) {\n    return value;\n  });\n  if (metricExp && !this.def.append) {\n    parameters.unshift(metricExp);\n  }\n\n  var funcRender = str + parameters.join(', ') + ')';\n  console.log(funcRender, this.def.append);\n  if (this.def.append) {\n    return metricExp + '.' + funcRender;\n  } else {\n    return funcRender;\n  }\n};\n\nFuncInstance.prototype.updateParam = function(strValue, index) {\n  // handle optional parameters\n  // if string contains ',' and next param is optional, split and update both\n\n  if (strValue === '' && this.def.params[index].optional) {\n    this.params.splice(index, 1);\n  }\n  else {\n    this.params[index] = strValue;\n  }\n\n  this.updateText();\n};\n\nFuncInstance.prototype.updateText = function () {\n  if (this.params.length === 0) {\n    this.text = this.def.name + '()';\n    return;\n  }\n\n  var text = this.def.name + '(';\n  text += this.params.join(', ');\n  text += ')';\n  this.text = text;\n};\n\nvar createFuncInstance = function(funcDef, options) {\n  if (_.isString(funcDef)) {\n    if (!index[funcDef]) {\n      throw { message: 'Method not found ' + name };\n    }\n    funcDef = index[funcDef];\n  }\n  return new FuncInstance(funcDef, options);\n};\n\nvar getFuncDef = function(name) {\n  return index[name];\n};\n\nvar getCategories = function() {\n  return categories;\n};\n\nvar foo;\n\nexport default foo = {\n  createFuncInstance: createFuncInstance,\n  getFuncDef: getFuncDef,\n  getCategories: getCategories,\n};\n\n"],"file":"dfunc.js"}